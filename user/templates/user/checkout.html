{% extends "home.html" %} {% load static %} {% block main_section %}
<div
  class="container mx-auto px-4 py-8 lg:max-w-7xl md:max-w-4xl sm:max-w-xl max-w-full"
>
  <h2
    class="text-2xl sm:text-3xl font-bold text-gray-900 dark:text-white mb-6 sm:mb-8"
  >
    Checkout
  </h2>

  <!-- Messages -->
  {% for msg in messages %} {% if msg.level == DEFAULT_MESSAGE_LEVELS.SUCCESS %}
  <div
    class="flex items-center p-4 mb-6 text-sm text-green-800 border border-green-300 rounded-lg bg-green-50 dark:bg-gray-800 dark:text-green-400 dark:border-green-800"
    role="alert"
  >
    <svg
      class="shrink-0 w-4 h-4 mr-3"
      aria-hidden="true"
      xmlns="http://www.w3.org/2000/svg"
      fill="currentColor"
      viewBox="0 0 20 20"
    >
      <path
        d="M10 .5a9.5 9.5 0 1 0 9.5 9.5A9.51 9.51 0 0 0 10 .5ZM13.5 7.5l-4 4-2-2a1 1 0 0 0-1.4 1.4l3 3a1 1 0 0 0 1.4 0l5-5a1 1 0 0 0-1.4-1.4Z"
      />
    </svg>
    <span class="sr-only">Success</span>
    <div>{{ msg }}</div>
  </div>
  {% elif msg.level == DEFAULT_MESSAGE_LEVELS.ERROR %}
  <div
    class="flex items-center p-4 mb-6 text-sm text-red-800 border border-red-300 rounded-lg bg-red-50 dark:bg-gray-800 dark:text-red-400 dark:border-red-800"
    role="alert"
  >
    <svg
      class="shrink-0 w-4 h-4 mr-3"
      aria-hidden="true"
      xmlns="http://www.w3.org/2000/svg"
      fill="currentColor"
      viewBox="0 0 20 20"
    >
      <path
        d="M10 .5a9.5 9.5 0 1 0 9.5 9.5A9.51 9.51 0 0 0 10 .5ZM11 15h-2v-2h2v2Zm0-4h-2V5h2v6Z"
      />
    </svg>
    <span class="sr-only">Error</span>
    <div>{{ msg }}</div>
  </div>
  {% endif %} {% endfor %} {% if items %}
  <div class="grid lg:grid-cols-3 gap-8">
    <!-- Cart Summary -->
    <div class="lg:col-span-2">
      <div class="bg-white dark:bg-gray-800 shadow-md sm:rounded-lg p-6">
        <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-4">
          Order Summary
        </h3>
        <table
          class="w-full text-sm text-left text-gray-500 dark:text-gray-400"
        >
          <thead
            class="text-xs text-gray-700 uppercase bg-gray-50 dark:bg-gray-700 dark:text-gray-400"
          >
            <tr>
              <th scope="col" class="px-6 py-3">Product</th>
              <th scope="col" class="px-6 py-3">Price</th>
              <th scope="col" class="px-6 py-3">Quantity</th>
              <th scope="col" class="px-6 py-3">Total</th>
            </tr>
          </thead>
          <tbody>
            {% for item in items %}
            <tr class="border-b dark:border-gray-700 bg-white dark:bg-gray-900">
              <td class="px-6 py-4">
                <div class="flex items-center space-x-4">
                  {% if item.product.image %}
                  <img
                    src="{{ item.product.image.url }}"
                    alt="{{ item.product.product_name }}"
                    class="w-16 h-16 object-contain rounded"
                  />
                  {% else %}
                  <div
                    class="w-16 h-16 bg-gray-200 rounded flex items-center justify-center"
                  >
                    <span class="text-xs text-gray-500">No Image</span>
                  </div>
                  {% endif %}
                  <span class="font-medium text-gray-900 dark:text-white"
                    >{{ item.product.product_name }}</span
                  >
                </div>
              </td>
              <td class="px-6 py-4">
                ${{ item.product.product_price|floatformat:2 }}
              </td>
              <td class="px-6 py-4">{{ item.quantity }}</td>
              <td class="px-6 py-4">${{ item.total_price|floatformat:2 }}</td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>

    <!-- Checkout Form -->
    <div class="lg:col-span-1">
      <div class="bg-white dark:bg-gray-800 shadow-md sm:rounded-lg p-6">
        <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-4">
          Billing Details
        </h3>
        <form method="POST" class="space-y-4">
          {% csrf_token %}
          <div>
            <label
              for="address"
              class="block text-sm font-medium text-gray-700 dark:text-gray-300"
              >Address</label
            >
            <input
              type="text"
              id="address"
              name="address"
              required
              class="w-full mt-1 p-2 border border-gray-300 rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white"
            />
          </div>
          <div>
            <label
              for="contact_no"
              class="block text-sm font-medium text-gray-700 dark:text-gray-300"
              >Contact Number</label
            >
            <input
              type="text"
              id="contact_no"
              name="contact_no"
              required
              class="w-full mt-1 p-2 border border-gray-300 rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white"
            />
          </div>
          <div>
            <label
              for="email"
              class="block text-sm font-medium text-gray-700 dark:text-gray-300"
              >Email</label
            >
            <input
              type="email"
              id="email"
              name="email"
              required
              value="{{ request.user.email }}"
              class="w-full mt-1 p-2 border border-gray-300 rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white"
            />
          </div>
          <div>
            <label
              for="payment_method"
              class="block text-sm font-medium text-gray-700 dark:text-gray-300"
              >Payment Method</label
            >
            <select
              id="payment_method"
              name="payment_method"
              required
              class="w-full mt-1 p-2 border border-gray-300 rounded dark:bg-gray-700 dark:border-gray-600 dark:text-white"
            >
              {% for value, label in Order.PAYMENT_METHOD %}
              <option value="{{ value }}">{{ label }}</option>
              {% endfor %}
            </select>
          </div>
          <div
            class="flex justify-between text-base font-semibold text-gray-900 dark:text-white mt-6"
          >
            <span>Total</span>
            <span>${{ cart_subtotal|floatformat:2 }}</span>
          </div>
          <button
            type="submit"
            class="block w-full bg-blue-600 text-white py-3 rounded-lg hover:bg-blue-700 dark:bg-blue-500 dark:hover:bg-blue-600 transition duration-150"
            aria-label="Place your order"
          >
            Place Order
          </button>
        </form>
      </div>
    </div>
  </div>
  {% else %}
  <div class="text-center py-12">
    <svg
      class="mx-auto w-16 h-16 text-gray-400 dark:text-gray-500 mb-4"
      fill="none"
      stroke="currentColor"
      viewBox="0 0 24 24"
      xmlns="http://www.w3.org/2000/svg"
      aria-hidden="true"
    >
      <path
        stroke-linecap="round"
        stroke-linejoin="round"
        stroke-width="2"
        d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"
      ></path>
    </svg>
    <h3 class="text-lg font-medium text-gray-900 dark:text-white mb-2">
      Your cart is empty
    </h3>
    <p class="text-gray-500 dark:text-gray-400 mb-6">
      Looks like you haven't added any items to your cart yet.
    </p>
    <a
      href="{% url 'productpage' %}"
      class="inline-block bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 dark:bg-blue-500 dark:hover:bg-blue-600 transition duration-150"
      aria-label="Continue shopping"
    >
      Continue Shopping
    </a>
  </div>
  {% endif %}
</div>
{% endblock main_section %}
